# gophKeeper

Разработка клиент-серверной системы, позволяющая пользователю надёжно и безопасно хранить логины, пароли и прочую приватную информацию  

Система с использованием gRPC со следующими требованиями:

## Сервер:

регистрация, аутентификация и авторизация пользователей;
хранение приватных данных;
передача приватных данных владельцу по запросу

## Клиент:

аутентификация и авторизация пользователей на удалённом сервере;
доступ к приватным данным по запросу.
Дополнительные требования:

поддержка терминального интерфейса (TUI — terminal user interface);
использование бинарного протокола;


# Настройка tls
1) openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes


# Назначение системы
Клиент-серверное приложение, предназначенное для безопасного хранения управления конфиденциальной информацией пользователей, включая логины, пароли, и бинарные данные.
Основная цель - обеспечить удобный и защищенный способ хранения и доступа к чувствительной информации.

# Основные компоненты
- Клиент
- Сервер
- База данных(Postgres)
- Docker

# Ключевые особенности:

# Хранимые данные
- Пары логин/пароль
- Произвольные текстовые данные
- Произвольные бинарные данные
- Данные банковских карт

# Используемые библиотеки:
- [Grpc](https://pkg.go.dev/google.golang.org/grpc) - удалённый вызов процедур
- [Jwtauth](https://github.com/go-chi/jwtauth) - библиотека для работы с jwt токеном
- [Logrus](https://github.com/sirupsen/logrus) - библиотека для работы с логами
- [pgx](https://github.com/jackc/pgx) - библиотека для работы с бд(Postgres)
- [golang-migrate](https://github.com/golang-migrate/migrate) - библиотека для работы с миграциями
- [OTP](https://github.com/pquerna/otp) - библиотека для OTP(one time password)
- [TUI](https://github.com/marcusolsson/tui-go) -библиотека с поддержкой терминального интерфейса - TUI(terminal user interface)
- [godoc](#) -  
- [go-keyring](https://github.com/zalando/go-keyring) - для безопасного хранения данных на клиенте

# Архитектура
## Сервер
Используется гексагональная архитектура - использование нескольких слоёв
1) Обработка grpc запросов. Преобразование protobuf в сущности
2) Реализация бизнес логики
3) Сохранение и извлечение данных
4) Слой утилит(логирование и тд)

## Клиент
Используется гексагональная архитектура - использование нескольких слоёв
1) Пользовательский интерфейс(UI)
2) Реализация бизнес логики
3) gRPC клиент для коммуникации с сервером
4) Слой утилит(логирование и тд)
5) Хранение и представление информации о версии и дате сборки

# Используемые паттерны проектирования
1) Репозиторий - Для абстрагирования работы с хранилищем данных
2) Адаптер - Для преобразования данных между protobuf и вашими доменными объектами
3) Декоратор - Для добавления дополнительной функциональности к объектам, например, логирования или кэширования
4) Eav - немного переделанный. Разделение данных о клиенте по таблицам. Связь по user_id

# Использование горутин:
1) Синхронизация данных между сервером и клиентом
2) Обработка пользовательского ввода
3) Обработка запросов

# База данных

## Таблица users

| Колонка    | Тип данных  | Описание                                      |
|------------|-------------|-----------------------------------------------|
| id         | BIGINT      | Уникальный идентификатор пользователя(PK, AI) |
| login      | VARCHAR(50) | Имя пользователя (UNIQUE, index, not null)    |
| password   | binary      | Пароль пользователя(not null)                 |
| salt       | VARCHAR(50) | Соль при хешировании пароля(not null)         |
| created_at | TIMESTAMP   | Дата создания пользователя                    |
| updated_at | TIMESTAMP   | Дата создания пользователя                    |


## Таблица entities

| Колонка    | Тип данных                                  | Описание                                       |
|------------|---------------------------------------------|------------------------------------------------|
| id         | BIGINT                                      | Уникальный идентификатор записи (PK, AI)       |
| user_id    | BIGINT                                      | ID пользователя (FK to Users, index, not null) |
| type       | ENUM('login', 'password', 'binary', 'note') | Тип записи (not null)                          |
| title      | VARCHAR(255)                                | Заголовок записи (not null)                    |
| created_at | TIMESTAMP                                   | Дата создания записи                           |
| updated_at | TIMESTAMP                                   | Дата последнего обновления записи              |

## Таблица login_data

| Колонка    | Тип данных    | Описание                                          |
|------------|---------------|---------------------------------------------------|
| id         | BIGINT        | Уникальный идентификатор записи логина (PK, AI)   |
| entry_id   | BIGINT        | ID связанной записи (FK to entities, index)       |
| username   | VARCHAR(255)  | Имя пользователя для входа (not null)             |
| password   | binary        | Зашифрованный пароль (not null)                   |
| url        | VARCHAR(2048) | URL связанного сервиса                            |
| notes      | TEXT          | Зашифрованные заметки                             |
| created_at | TIMESTAMP     | Дата создания записи                              |
| updated_at | TIMESTAMP     | Дата последнего обновления записи                 |

## Таблица binary_data
| Колонка  | Тип данных    | Описание                                        |
|----------|---------------|-------------------------------------------------|
| id       | BIGINT        | Уникальный идентификатор записи логина (PK, AI) |
| entry_id | BIGINT        | ID связанной записи (FK to entities, index)     |
| path     | VARCHAR(255)  | Путь до файла                                   |
| notes    | TEXT          | Зашифрованные заметки                           |

## Таблица text_data
| Колонка    | Тип данных      | Описание                                          |
|------------|-----------------|---------------------------------------------------|
| id         | BIGINT          | Уникальный идентификатор записи логина (PK, AI)   |
| entry_id   | BIGINT          | ID связанной записи (FK to entities, index)       |
| path       | VARCHAR(255)    | Путь до файла                                     |
| notes      | TEXT            | Зашифрованные заметки                             |
